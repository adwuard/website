"use strict";(self.webpackChunkchaos_mesh_website=self.webpackChunkchaos_mesh_website||[]).push([[7864],{4185:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>_,default:()=>x,frontMatter:()=>r,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"tkl-api/tkl_uart","title":"UART Driver","description":"Brief Description","source":"@site/i18n/zh/docusaurus-plugin-content-docs/current/tkl-api/tkl_uart.md","sourceDirName":"tkl-api","slug":"/tkl-api/tkl_uart","permalink":"/website/zh/docs/tkl-api/tkl_uart","draft":false,"unlisted":false,"editUrl":"https://github.com/tuya/TuyaOpen/edit/master/i18n/zh/docusaurus-plugin-content-docs/current/tkl-api/tkl_uart.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"HW Timer Driver","permalink":"/website/zh/docs/tkl-api/tkl_timer"},"next":{"title":"WAKEUP Driver","permalink":"/website/zh/docs/tkl-api/tkl_wakeup"}}');var i=t(4848),s=t(8453);const r={},_="UART Driver",d={},c=[{value:"Brief Description",id:"brief-description",level:2},{value:"API Description",id:"api-description",level:2},{value:"tkl_uart_init",id:"tkl_uart_init",level:3},{value:"TUYA_UART_PARITY_TYPE_E:",id:"tuya_uart_parity_type_e",level:4},{value:"TUYA_UART_DATA_LEN_E:",id:"tuya_uart_data_len_e",level:4},{value:"TUYA_UART_STOP_LEN_E:",id:"tuya_uart_stop_len_e",level:4},{value:"TUYA_UART_FLOWCTRL_TYPE_E:",id:"tuya_uart_flowctrl_type_e",level:4},{value:"tkl_uart_deinit:",id:"tkl_uart_deinit",level:3},{value:"tkl_uart_write:",id:"tkl_uart_write",level:3},{value:"tkl_uart_rx_irq_cb_reg:",id:"tkl_uart_rx_irq_cb_reg",level:3},{value:"tkl_uart_tx_irq_cb_reg:",id:"tkl_uart_tx_irq_cb_reg",level:3},{value:"tkl_uart_read:",id:"tkl_uart_read",level:3},{value:"tkl_uart_set_tx_int:",id:"tkl_uart_set_tx_int",level:3},{value:"tkl_uart_set_rx_flowctrl:",id:"tkl_uart_set_rx_flowctrl",level:3},{value:"tkl_uart_wait_for_data\uff1a",id:"tkl_uart_wait_for_data",level:3},{value:"tkl_uart_ioctl\uff1a",id:"tkl_uart_ioctl",level:3},{value:"TUYA_UART_IOCTL_CMD_E\uff1a",id:"tuya_uart_ioctl_cmd_e",level:4},{value:"1. UART Example 1",id:"1-uart-example-1",level:2},{value:"2. UART Example 2",id:"2-uart-example-2",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"uart-driver",children:"UART Driver"})}),"\n",(0,i.jsx)(n.h2,{id:"brief-description",children:"Brief Description"}),"\n",(0,i.jsx)(n.p,{children:"UART (Universal Asynchronous Receiver/Transmitter) is a universal serial data bus used for asynchronous communication. This bus supports two-way communication, enabling full-duplex transmission and reception."}),"\n",(0,i.jsx)(n.h2,{id:"api-description",children:"API Description"}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_init",children:"tkl_uart_init"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"OPERATE_RET tkl_uart_init(TUYA_UART_NUM_E port_id, TUYA_UART_BASE_CFG_T *cfg);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Initializes the corresponding UART instance via the port number and basic configuration, returning the initialization result."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"port_id"}),": Port number."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"cfg"}),": UART basic configuration, including baud rate, parity bit, stop bit, and flow control"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef struct {\n    uint32_t                    baudrate;\n    TUYA_UART_PARITY_TYPE_E     parity;\n    TUYA_UART_DATA_LEN_E        databits;\n    TUYA_UART_STOP_LEN_E        stopbits;\n    TUYA_UART_FLOWCTRL_TYPE_E   flowctrl;\n} TUYA_UART_BASE_CFG_T;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"tuya_uart_parity_type_e",children:"TUYA_UART_PARITY_TYPE_E:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Name"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Definition"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Remarks"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_PARITY_TYPE_NONE"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x0 (No parity bit)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_PARITY_TYPE_ODD"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x1 (Odd parity bit)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_PARITY_TYPE_EVEN"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x2 (Even parity bit)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"tuya_uart_data_len_e",children:"TUYA_UART_DATA_LEN_E:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Name"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Definition"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Remarks"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_DATA_LEN_5BIT"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x5 (5-bit data length)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_DATA_LEN_6BIT"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x6 (6-bit data length)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_DATA_LEN_7BIT"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x7 (7-bit data length)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_DATA_LEN_8BIT"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x8 (8-bit data length)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"tuya_uart_stop_len_e",children:"TUYA_UART_STOP_LEN_E:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Name"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Definition"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Remarks"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_STOP_LEN_1BIT"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x1 (1-bit stop bit)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_STOP_LEN_1_5BIT1"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x2 (1.5-bit stop bit)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_STOP_LEN_2BIT"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x3 (2-bit stop bit)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"tuya_uart_flowctrl_type_e",children:"TUYA_UART_FLOWCTRL_TYPE_E:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Name"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Definition"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Remarks"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_FLOWCTRL_NONE"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x0 (No flow control)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_FLOWCTRL_RTSCTS"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x1 (Request/Clear to Send)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_FLOWCTRL_XONXOFF"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x2 (Transmit/Receive On/Off)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_FLOWCTRL_DTRDSR"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x3 (Data Terminal Ready/Data Set Ready)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["OPRT_OK Success, others please refer to the file ",(0,i.jsx)(n.code,{children:"tuya_error_code.h"}),", UART type definition section."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_deinit",children:"tkl_uart_deinit:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"OPERATE_RET tkl_uart_deinit(TUYA_UART_NUM_E port_id);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"UART deinitialization. This interface will stop the UART."}),"\n",(0,i.jsx)(n.li,{children:"Ends any ongoing transmission (if any) and releases related software and hardware resources."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"port_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["OPRT_OK Success, others please refer to the file ",(0,i.jsx)(n.code,{children:"tuya_error_code.h"}),", UART type definition section."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_write",children:"tkl_uart_write:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"int tkl_uart_write(TUYA_UART_NUM_E port_id, void *buff, uint16_t len);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"UART sends data."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"part_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"buff"}),": Data buffer to send."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"len"}),": Length of data to send."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:">=0"})," Length of data sent."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"< 0 "})," Error sending data."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_rx_irq_cb_reg",children:"tkl_uart_rx_irq_cb_reg:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"void tkl_uart_rx_irq_cb_reg(TUYA_UART_NUM_E port_id, TUYA_UART_IRQ_CB rx_cb);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Registers the UART receive interrupt callback function."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"part_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"rx_cb"}),": Receive interrupt callback function."]}),"\n",(0,i.jsxs)(n.p,{children:["Callback function type ",(0,i.jsx)(n.code,{children:"TUYA_UART_IRQ_CB"})," is defined as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef void (*TUYA_UART_IRQ_CB)(TUYA_UART_NUM_E port_id);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Where ",(0,i.jsx)(n.code,{children:"port_id"})," is the port number."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"void"}),": None"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_tx_irq_cb_reg",children:"tkl_uart_tx_irq_cb_reg:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"void tkl_uart_tx_irq_cb_reg(TUYA_UART_NUM_E port_id, TUYA_UART_IRQ_CB tx_cb);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Registers the UART transmit interrupt callback function."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"part_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tx_cb"}),": Transmit interrupt callback function."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Callback function type ",(0,i.jsx)(n.code,{children:"TUYA_UART_IRQ_CB"})," is defined as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef void (*TUYA_UART_IRQ_CB)(TUYA_UART_NUM_E port_id);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Where ",(0,i.jsx)(n.code,{children:"port_id"})," is the port number."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"void"}),": None"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_read",children:"tkl_uart_read:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"int tkl_uart_read(TUYA_UART_NUM_E port_id, void *buff, uint16_t len);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Reads data from the UART."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"part_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"buff"}),": Data receive buffer."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"len"}),": Length of data to receive."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:">=0"})," Length of data received."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"< 0 "})," Error receiving data."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_set_tx_int",children:"tkl_uart_set_tx_int:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"OPERATE_RET tkl_uart_set_tx_int(TUYA_UART_NUM_E port_id, BOOL_T enable);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Enable/disable UART transmit interrupt"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"port_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"enable"}),": Interrupt enable/disable","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0: disable"}),"\n",(0,i.jsx)(n.li,{children:"1: enable"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["OPRT_OK Success, others please refer to the file ",(0,i.jsx)(n.code,{children:"tuya_error_code.h"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_set_rx_flowctrl",children:"tkl_uart_set_rx_flowctrl:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"OPERATE_RET tkl_uart_set_rx_flowctrl(TUYA_UART_NUM_E port_id, BOOL_T enable);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Enable/disable UART receive flow control."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"port_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"enable"}),": Flow control enable/disable","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"0: disable"}),"\n",(0,i.jsx)(n.li,{children:"1: enable"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["OPRT_OK Success, others please refer to the file ",(0,i.jsx)(n.code,{children:"tuya_error_code.h"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_wait_for_data",children:"tkl_uart_wait_for_data\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"OPERATE_RET tkl_uart_wait_for_data(TUYA_UART_NUM_E port_id, int timeout_ms);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Waits for received data"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"port_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"timeout_ms"}),": Wait time in milliseconds."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["OPRT_OK Success, others please refer to the file ",(0,i.jsx)(n.code,{children:"tuya_error_code.h"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tkl_uart_ioctl",children:"tkl_uart_ioctl\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"OPERATE_RET tkl_uart_ioctl(TUYA_UART_NUM_E port_id, uint32_t cmd, void *arg);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Function Description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"UART command control"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"port_id"}),": Port number."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,\t\t    // UART 0\n    TUYA_UART_NUM_1,\t\t    // UART 1\n    TUYA_UART_NUM_2,\t        // UART 2\n    TUYA_UART_NUM_3,\t        // UART 3\n    TUYA_UART_NUM_4,\t        // UART 4\n    TUYA_UART_NUM_5,\t        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"cmd"}),": UART control command."]}),"\n",(0,i.jsx)(n.h4,{id:"tuya_uart_ioctl_cmd_e",children:"TUYA_UART_IOCTL_CMD_E\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Name"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Definition"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Remarks"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_SUSPEND_CMD"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x0 (Suspend UART)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_RESUME_CMD"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x1 (Resume UART)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_FLUSH_CMD"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x2 (Flush UART buffer)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_RECONFIG_CMD"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x3 (Reinitialize UART)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TUYA_UART_USER_CMD"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"0x4 (User-defined command)"}),(0,i.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"arg"}),": Parameters corresponding to the control command"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Return Value:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["OPRT_OK Success, others please refer to the file ",(0,i.jsx)(n.code,{children:"tuya_error_code.h"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.h2,{id:"1-uart-example-1",children:"1. UART Example 1"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"int uart_loopback_test(void)\n{\n    uint32_t port_id;\n    TUYA_UART_BASE_CFG_T cfg;\n    OPERATE_RET ret = OPRT_OK;\n    const int bufsize = 8;\n    unsigned char tx[bufsize], rx[bufsize];\n    int bytes;\n    int i;\n\n    // start\n    port_id = TUYA_UART_NUM_0;\n\n    cfg.baudrate = 115200;\n    cfg.databits = TUYA_UART_DATA_LEN_8BIT;\n    cfg.parity = TUYA_UART_PARITY_TYPE_NONE;\n    cfg.stopbits = TUYA_UART_STOP_LEN_1BIT;\n    cfg.flowctrl = TUYA_UART_FLOWCTRL_NONE;\n\n    ret = tkl_uart_init(port_id, &cfg);\n\n    for (i = 0; i < bufsize; i++) {\n        tx[i] = 'A' + i;\n    }\n\n    // loop 3 times\n    for(i = 0; i < 3; i ++) {\n        bzero(rx, sizeof(rx));\n\n        bytes = tkl_uart_write(port_id, tx, sizeof(tx));\n        if (bytes <= 0) {\n            // fail\n            ret = OPRT_COM_ERROR;\n         } else {\n             // wait at most 5 seconds until the data is ready\n            ret = tkl_uart_wait_for_data(port_id, 5000);\n            if (ret == OPRT_TIMEOUT) {\n               // timeout\n               tkl_uart_deinit(port_id);\n               return OPRT_COM_ERROR;\n            }\n\n            bytes = tkl_uart_read(port_id, rx, sizeof(rx));\n            if (bytes < 0) {\n                // fail\n                ret = OPRT_COM_ERROR;\n            } else {\n                if (memcmp(tx, rx, bufsize) != 0) {\n                    // data is not identical\n                    ret = OPRT_COM_ERROR;\n                } else {\n                    ret = OPRT_OK;\n                }\n            }\n        }\n\n        if (ret != OPRT_OK) {\n            // fail\n        } else {\n            // ok\n        }\n    }\n    //deinit\n    tkl_uart_deinit(port_id);\n    return ret;\n}\n\n"})}),"\n",(0,i.jsx)(n.h2,{id:"2-uart-example-2",children:"2. UART Example 2"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"static int sg_rx_flag = 0;\nstatic int sg_tx_flag = 0;\n\nstatic void tuya_rx_cb(TUYA_UART_NUM_E port_id)\n{\n    // mutex lock\n    sg_rx_flag = 1;\n    // mutex unlock\n}\n\nstatic static void tuya_tx_cb(TUYA_UART_NUM_E port_id)\n{\n    // mutex lock\n    sg_tx_flag = 1;\n    // mutex unlock\n}\n\nint uart_loopback_test(void)\n{\n    uint32_t port_id;\n    TUYA_UART_BASE_CFG_T cfg;\n    OPERATE_RET ret = OPRT_OK;\n    const int bufsize = 8;\n    unsigned char tx[bufsize], rx[bufsize];\n    int bytes;\n    static int sl_first_time =1;\n    int i;\n\n    // start\n    sg_rx_flag = 0;\n    sg_tx_flag = 0;\n\n    port_id = TUYA_UART_NUM_0;\n\n    cfg.baudrate = 115200;\n    cfg.databits = TUYA_UART_DATA_LEN_8BIT;\n    cfg.parity = TUYA_UART_PARITY_TYPE_NONE;\n    cfg.stopbits = TUYA_UART_STOP_LEN_1BIT;\n    cfg.flowctrl = TUYA_UART_FLOWCTRL_NONE;\n\n    ret = tkl_uart_init(port_id, &cfg);\n\n    if(tkl_uart_set_tx_int(port_id,1) < 0) {\n        //fail\n        tkl_uart_deinit(port_id);\n        return OPRT_COM_ERROR;\n    }\n\n    for (i = 0; i < bufsize; i++) {\n        tx[i] = 'A' + i;\n    }\n\n    // loop 3 times\n    for(i=0;i<3;i++) {\n\n        bzero(rx, sizeof(rx));\n\n\n        if(sl_first_time || sg_tx_flag) {\n            bytes = tkl_uart_write(port_id, tx, sizeof(tx));\n        }else {\n            continue;\n        }\n\n        if (bytes <= 0) {\n            // fail\n             ret = OPRT_COM_ERROR;\n        } else {\n        // wait at most 5 seconds until the data is ready\n        ret = tkl_uart_wait_for_data(port_id, 5000);\n\n        if(sg_rx_flag) {\n            bytes = tkl_uart_read(port_id, rx, sizeof(rx));\n            if (bytes < 0) {\n               // fail\n               ret = OPRT_COM_ERROR;\n            } else {\n                if (memcmp(tx, rx, bufsize) != 0) {\n                // data is not identical\n                ret = OPRT_COM_ERROR;\n                } else {\n                    ret = OPRT_OK;\n                }\n            }\n            sg_rx_flag = 0;\n           }\n        }\n        if (ret != OPRT_OK) {\n        // fail\n        } else {\n        // ok\n        }\n    }\n    // disabe int\n    tkl_uart_set_tx_int(port_id,0);\n    //deinit\n    tkl_uart_deinit(port_id);\n    return ret;\n}\n\n"})})]})}function x(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>_});var l=t(6540);const i={},s=l.createContext(i);function r(e){const n=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function _(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);